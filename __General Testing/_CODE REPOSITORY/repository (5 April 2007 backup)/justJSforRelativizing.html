<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>
<head><base href="http://se-meeting.qa.optimost.com/" />
	<title>Hijacking Post methodology</title>
</head>

<body>
<div style="width: 690px; background-color: #000000; color: #FFFF00;padding:8px;border:4px solid brown;">
<strong>Just relativizing JS code</strong><br/><br/>With a single link as an example.  

</div>
<!-- **************** START START START START -  OPEN DIV TO SET DEFAULT CODE DISPLAY=NONE **************** -->
<script language="javascript">
document.write('<div style="display: none;" id="opIndexedContent">');
</script>
<!-- **************** START START START START -  OPEN DIV TO SET DEFAULT CODE DISPLAY=NONE **************** -->

<a href="/myMeetingNotes/all.cfm" id="mylink1" class="link">Here is the first link we will relativize</a>
<br/><br/>
<a href="taskList/some.php" id="mylink2" class="link">Here is the secondlink we will relativize</a>

<!-- **************** END END END END END END-  CLOSE DIV TO SET DEFAULT CODE DISPLAY=NONE **************** -->
<script language="javascript" type="text/javascript">
document.write('</div>');
</script>
<!-- **************** END END END END -  CLOSE DIV TO SET DEFAULT CODE DISPLAY=NONE **************** -->


<script language="javascript" type="text/javascript">
// This code pulls out the base path for this site.
if(document.getElementsByTagName('base')[0] != null){ // If we have a base statement, use that to set the root path
	daRoot = document.getElementsByTagName('base')[0].href;
	var orig = daRoot.split("//");
	protocol = orig[0] + '//';
	var dir = orig[1].split("/");
	var dirs = "";
	for(var i=0;i<dir.length-1;i++){
		dirs += (dir[i]!=''?dir[i] + '/':'');  
	
	}
	daBaseDomain = protocol + dir[0];
	daDomain = protocol + dir[0] + '/';
	daRoot = protocol + dirs;
}
else {
	var sPage = window.location.pathname;
	var dir = sPage.split("/");
	var dirs = "";
	var baseURL;
	for(var i=0;i<dir.length-1;i++){
		dirs += (dir[i]!=''?dir[i] + '/':''); 
	
	}
	daBaseDomain = location.protocol+"//"  + location.host;
	daDomain = location.protocol+"//"  + location.host + '/';
	daRoot = location.protocol+"//" + location.host + "/" + dirs;
}	
</script>

<!-- // Code BEFORE at the top of the Template Copy, before we create our content BEFORE BEFORE -->
<!-- // Code BEFORE at the top of the Template Copy, before we create our content BEFORE BEFORE -->
<!-- // Code BEFORE at the top of the Template Copy, before we create our content BEFORE BEFORE -->

<script language="javascript">
//Pull out the link of interest from the HIDDEN DIV area so we can relativize it.
//In this case, it is the single anchor tag on the page.  But use whatever method necessary
relLink= new Array;
num=0;
anchors=document.getElementsByTagName('a');
for(i=0;i<anchors.length;i++){
	if(anchors[i].className.indexOf('link')!=-1){
		tmpLink = anchors[i].href;
		tmpLink = tmpLink.substr(0,9);//parse just the first few characters for a compare
		if(tmpLink.substr(0,1)=='/') daRoot=daBaseDomain; 	//If the href has a "/" as the first character, 
																// then we need to relativize it to the root
		relLink[num]=((tmpLink.indexOf('http')==-1)?daRoot:'')+anchors[i].href;	//set the nth link to its new URL
		num++;
	}
}

</script>

<!-- Contents of  of Optimost Template Copy -->
<!-- Contents of  of Optimost Template Copy -->
<!-- Contents of  of Optimost Template Copy -->
<!-- Contents of  of Optimost Template Copy -->
<div id="myArea" style="border:2px red solid;">
<a href="http://by.optimost.com/go/2-1126/" class="link">Here is the first link we will relativize</a>
<br/><br/>
<a href="http://by.optimost.com/go/2-1127/" class="link">Here is the secondlink we will relativize</a>
</div>
<!-- Contents of  of Optimost Template Copy -->
<!-- Contents of  of Optimost Template Copy -->
<!-- Contents of  of Optimost Template Copy -->
<!-- Contents of  of Optimost Template Copy -->
<!-- Contents of  of Optimost Template Copy -->

<!-- // Code AFTER  we create the content, at the bottom of the Template Copy AFTER AFTER AFTER AFTER -->
<!-- // Code AFTER  we create the content, at the bottom of the Template Copy AFTER AFTER AFTER AFTER -->
<!-- // Code AFTER  we create the content, at the bottom of the Template Copy AFTER AFTER AFTER AFTER -->

<script language="javascript" native="no">
num2=0;
anchors=document.getElementById('myArea').getElementsByTagName('a');//Since I did not kill the content in the hidden area, I look for anchor tags
																	//inside the div with id="myArea"
for(i=0;i<anchors.length;i++){
	if(anchors[i].className.indexOf('link')!=-1){	// I have the same number of links, 2, so I assume there is a one-to-one correspondence
		anchors[i].href+=((anchors[i].href.indexOf('?') != -1)?'&':'?') +'link='+escape(relLink[num2]);
		num2++;
	}
}
</script>
<!-- **************** START START START START -  CODE TO DISPLAY DEFAULT CODE IF NO OPTIMOST **************** -->
<script language="javascript" type="text/javascript">
if ("boolean" != typeof(isOptimostCopyVisible)) document.getElementById('opIndexedContent').style.display = 'block';
</script>
<!-- **************** END END END END END END -  CODE TO DISPLAY DEFAULT CODE IF NO OPTIMOST **************** -->

			
</body>
</html>