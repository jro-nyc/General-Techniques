<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" dir="ltr" lang="en"><head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<meta name="generator" content="MediaWiki 1.13.1">
		<meta name="keywords" content="Clickthru - Tracking a DIV onclick">
		<link rel="shortcut icon" href="http://wiki.interwoven.com/favicon.ico">
		<link rel="search" type="application/opensearchdescription+xml" href="http://wiki.interwoven.com/opwiki/opensearch_desc.php" title="Optimost Wiki (en)">
		<link rel="alternate" type="application/rss+xml" title="Optimost Wiki RSS Feed" href="http://wiki.interwoven.com/opwiki/index.php?title=Special:RecentChanges&amp;feed=rss">
		<link rel="alternate" type="application/atom+xml" title="Optimost Wiki Atom Feed" href="http://wiki.interwoven.com/opwiki/index.php?title=Special:RecentChanges&amp;feed=atom">
		<title>Clickthru - Tracking a DIV onclick - Optimost Wiki</title>
		<style type="text/css" media="screen, projection">/*<![CDATA[*/
			@import "/opwiki/skins/common/shared.css?164";
			@import "/opwiki/skins/monobook/main.css?164";
		/*]]>*/</style>
		<link rel="stylesheet" type="text/css" media="print" href="Clickthru%20-%20Tracking%20a%20DIV%20onclick%20-%20Optimost%20Wiki_files/commonPrint.css">
		<!--[if lt IE 5.5000]><style type="text/css">@import "/opwiki/skins/monobook/IE50Fixes.css?164";</style><![endif]-->
		<!--[if IE 5.5000]><style type="text/css">@import "/opwiki/skins/monobook/IE55Fixes.css?164";</style><![endif]-->
		<!--[if IE 6]><style type="text/css">@import "/opwiki/skins/monobook/IE60Fixes.css?164";</style><![endif]-->
		<!--[if IE 7]><style type="text/css">@import "/opwiki/skins/monobook/IE70Fixes.css?164";</style><![endif]-->
		<!--[if lt IE 7]><script type="text/javascript" src="/opwiki/skins/common/IEFixes.js?164"></script>
		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->
		
		<script type="text/javascript">/*<![CDATA[*/
var skin = "monobook";
var stylepath = "/opwiki/skins";
var wgArticlePath = "/optimost/$1";
var wgScriptPath = "/opwiki";
var wgScript = "/opwiki/index.php";
var wgVariantArticlePath = false;
var wgActionPaths = [];
var wgServer = "http://wiki.interwoven.com";
var wgCanonicalNamespace = "";
var wgCanonicalSpecialPageName = false;
var wgNamespaceNumber = 0;
var wgPageName = "Clickthru_-_Tracking_a_DIV_onclick";
var wgTitle = "Clickthru - Tracking a DIV onclick";
var wgAction = "view";
var wgArticleId = "720";
var wgIsArticle = true;
var wgUserName = null;
var wgUserGroups = null;
var wgUserLanguage = "en";
var wgContentLanguage = "en";
var wgBreakFrames = false;
var wgCurRevisionId = "4580";
var wgVersion = "1.13.1";
var wgEnableAPI = true;
var wgEnableWriteAPI = false;
var wgRestrictionEdit = [];
var wgRestrictionMove = [];
/*]]>*/</script>
                
		<script type="text/javascript" src="Clickthru%20-%20Tracking%20a%20DIV%20onclick%20-%20Optimost%20Wiki_files/wikibits.js"><!-- wikibits js --></script>
		<!-- Head Scripts -->
		<script type="text/javascript" src="Clickthru%20-%20Tracking%20a%20DIV%20onclick%20-%20Optimost%20Wiki_files/ajax.js"></script>
		<script type="text/javascript" src="Clickthru%20-%20Tracking%20a%20DIV%20onclick%20-%20Optimost%20Wiki_files/index.php"><!-- site js --></script><script type="text/javascript" src="Clickthru%20-%20Tracking%20a%20DIV%20onclick%20-%20Optimost%20Wiki_files/index_002.php"></script>
		<style type="text/css">/*<![CDATA[*/
@import "/opwiki/index.php?title=MediaWiki:Common.css&usemsgcache=yes&action=raw&ctype=text/css&smaxage=18000";
@import "/opwiki/index.php?title=MediaWiki:Monobook.css&usemsgcache=yes&action=raw&ctype=text/css&smaxage=18000";
@import "/opwiki/index.php?title=-&action=raw&gen=css&maxage=18000";
/*]]>*/</style>
	</head>
<body class="mediawiki ns-0 ltr page-Clickthru_-_Tracking_a_DIV_onclick">
	<div id="globalWrapper">
		<div id="column-content">
	<div id="content">
		<a name="top" id="top"></a>
				<h1 class="firstHeading">Clickthru - Tracking a DIV onclick</h1>
		<div id="bodyContent">
			<h3 id="siteSub">From Optimost Wiki</h3>
			<div id="contentSub"></div>
									<div id="jump-to-nav">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>			<!-- start content -->
			<table id="toc" class="toc" summary="Contents"><tbody><tr><td><div id="toctitle"><h2>Contents</h2> <span class="toctoggle">[<a href="javascript:toggleToc()" class="internal" id="togglelink">hide</a>]</span></div>
<ul>
<li class="toclevel-1"><a href="#Introduction"><span class="tocnumber">1</span> <span class="toctext">Introduction</span></a>
<ul>
<li class="toclevel-2"><a href="#Example_HTML"><span class="tocnumber">1.1</span> <span class="toctext">Example HTML</span></a></li>
<li class="toclevel-2"><a href="#DIV_clicktracking_code"><span class="tocnumber">1.2</span> <span class="toctext">DIV clicktracking code</span></a></li>
<li class="toclevel-2"><a href="#Clicktracking_code_for_anchor_or_form_tags"><span class="tocnumber">1.3</span> <span class="toctext">Clicktracking code for anchor or form tags</span></a></li>
</ul>
</li>
</ul>
</td></tr></tbody></table><script type="text/javascript"> if (window.showTocToggle) { var tocShowText = "show"; var tocHideText = "hide"; showTocToggle(); } </script>
<a name="Introduction"></a><h2> <span class="mw-headline">Introduction</span></h2>
<p>You may have an instance where you have a DIV with on "onclick" that redirects using <b>window.location</b>, <b>document.location</b>, or <b>top.location</b>.   How do we track that.
</p>
<a name="Example_HTML"></a><h3> <span class="mw-headline">Example HTML</span></h3>
<p>Let's say the HTML of interest looks like this:
</p>
<pre>&lt;div onclick="top.location = '/mytest/q2_overview.html';" id="testArea" style="border:red solid 1px;width:400px" onmouseover="this.style.cursor='pointer';" onmouseout=""&gt;
   	&lt;div style="padding:50px;"&gt;
		&lt;span style="color: rgb(0, 0, 0);" id="largeTeaserText1_1" class="h1LargeTeaserText"&gt;Car Car Car!&lt;/span&gt;
   	&lt;/div&gt;
	&lt;div style="padding:50px;"&gt;
		&lt;span style="color: rgb(0, 0, 0);" id="largeTeaserText2_1" class="h1LargeTeaserText"&gt;Truck Truck Truck!&lt;/span&gt;
	&lt;/div&gt;
	&lt;div style="padding:50px;"&gt;
		&lt;a href="/mytest/q2_overview.html"&gt;
			&lt;img class="arrowWhite" src="/_common/html/img/palette/1x1_trans.gif" border="0"/&gt;
		&lt;/a&gt;
	&lt;/div&gt;
	&lt;div style="padding:50px;" class="largeTeaserLinkBackgroundTransparent"&gt;
		&lt;a class="largeTeaserLinkTextColor" href="/mytest/q2_overview.html" id="largeTeaserLink_1"&gt;
			&lt;img class="arrowWhite" src="/_common/html/img/palette/1x1_trans.gif"/ border="0"&gt;&lt;br/&gt;Van Van Van
		&lt;/a&gt;
	&lt;/div&gt;
&lt;/div&gt;
</pre>
<p>Since its a DIV, we need to add an onmouseover event so the visitor 
will see a cursor.  So for that this is the code that tracks the click
</p>
<a name="DIV_clicktracking_code"></a><h3> <span class="mw-headline">DIV clicktracking code</span></h3>
<pre>$opt={};
//Create the new onclick creation function for DIVs
$opt.divClickthru = function (o, ct, qsParam,onclickLocParam){
	if(o.originaltarget!=null) return false;
	if(typeof(o.onclick)!="function") return false;
	var origOnclick=o.onclick.toString();
	var temp=origOnclick.substring(origOnclick.indexOf("{") + 1, origOnclick.lastIndexOf("}"));
	temp=temp.replace(onclickLocParam,'');
	temp=temp.replace(/=|'|"|;/g,'');
	temp=temp.replace(/^\s*|\s*$/g,'');//Remove all whitespace before or after the string
	var h=temp;
	if (h.substr(0,4)&nbsp;!= "http"){
		if (h.substr(0,1) == "/"){// relative to document domain
			h = location.protocol + "//" +location.host + h;
		}
		else {// relative to document path
			path=location.pathname.substr(0,location.pathname.lastIndexOf('/')+1);
			h = location.protocol + "//" +location.host + path + h;
		}
	}	
	o.originaltarget = h;	
	h = ct+(ct.indexOf('?')==-1?'?':'&amp;') + qsParam +'=' + escape(h);

	o.onclick=new Function("top.location='"+h+"';"+origOnclick);
	return true;
}

//Find the DIV and call the onclick creation function
var ourTest=document.getElementById('testArea');
var ct='http://by.optimost.com/go/0-0/a00d01m02v3v6ebc/';
if(ourTest!=null){
	$opt.divClickthru(ourTest, ct, 'oplink','top.location');
}
&lt;/script&gt;
</pre>
<p>Test and see, and don't mind that the clickthru fails - its not a real click value.  
</p><p>You will notice one issue - when you click on the images or links
 inside anchor tags, the DIV onclick does not get invoked.  To track 
those, you will need to use the standard click tracking code, and add to
 all anchor tag.  Just add the code below:
</p>
<a name="Clicktracking_code_for_anchor_or_form_tags"></a><h3> <span class="mw-headline">Clicktracking code for anchor or form tags</span></h3>
<pre>//.....DIV tracking code above........
//.....
$opt.clickthru = function (o, ct, qsParam){
	if(o.originaltarget!=null) return false;
	if (o.tagName.toLowerCase() == "form") h=o.action;
	else h=o.href;	   
	port='';	
	if (h.substr(0,4)&nbsp;!= "http"){
		if (h.substr(0,1) == "/"){// relative to document domain
			h = location.protocol + "//" +location.host + h;
		}
		else {// relative to document path
			path=location.pathname.substr(0,location.pathname.lastIndexOf('/')+1);
			h = location.protocol + "//" +location.host + path + h;
		}
	}	
	o.originaltarget = h;	
	h = ct+(ct.indexOf('?')==-1?'?':'&amp;') + qsParam +'=' + escape(h);

	if (o.tagName.toLowerCase() == "form")
		o.action= h;
	else
		o.href= h;
	return true;
}

if(ourTest!=null){
	var anchors=ourTest.getElementsByTagName('a');
	for(var i=0;i&lt;anchors.length;i++) {
		if(typeof(anchors[i].onclick)!="function") anchors[i].onclick=new Function("$opt.clickthru(this,'"+ct+"','oplink');return true;");
		else{
			temp=anchors[i].onclick.toString();
			temp=temp.substring(temp.indexOf("{") + 1, temp.lastIndexOf("}"));
			anchors[i].onclick=new Function("$opt.clickthru(this,'"+ct+"','oplink');"+temp);
		}	
	}
}
</pre>

<!-- 
NewPP limit report
Preprocessor node count: 14/1000000
Post-expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key optimost_wiki:pcache:idhash:720-0!1!0!!en!2!edit=0 and timestamp 20130816144519 -->
<div class="printfooter">
Retrieved from "<a href="http://wiki.interwoven.com/optimost/Clickthru_-_Tracking_a_DIV_onclick">http://wiki.interwoven.com/optimost/Clickthru_-_Tracking_a_DIV_onclick</a>"</div>
						<!-- end content -->
			<div class="visualClear"></div>
		</div>
	</div>
		</div>
		<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<div class="pBody">
			<ul>
	
				 <li id="ca-nstab-main" class="selected"><a href="http://wiki.interwoven.com/optimost/Clickthru_-_Tracking_a_DIV_onclick" title="View the content page [alt-shift-c]" accesskey="c">Page</a></li>
				 <li id="ca-talk" class="new"><a href="http://wiki.interwoven.com/opwiki/index.php?title=Talk:Clickthru_-_Tracking_a_DIV_onclick&amp;action=edit" title="Discussion about the content page [alt-shift-t]" accesskey="t">Discussion</a></li>
				 <li id="ca-viewsource"><a href="http://wiki.interwoven.com/opwiki/index.php?title=Clickthru_-_Tracking_a_DIV_onclick&amp;action=edit" title="This page is protected.
You can view its source. [alt-shift-e]" accesskey="e">View source</a></li>
				 <li id="ca-history"><a href="http://wiki.interwoven.com/opwiki/index.php?title=Clickthru_-_Tracking_a_DIV_onclick&amp;action=history" title="Past versions of this page. [alt-shift-h]" accesskey="h">History</a></li>			</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
				<li id="pt-anonuserpage"><a href="http://wiki.interwoven.com/optimost/User:10.26.10.11" title="The user page for the ip you're editing as [alt-shift-.]" accesskey="." class="new">10.26.10.11</a></li>
				<li id="pt-anontalk"><a href="http://wiki.interwoven.com/optimost/User_talk:10.26.10.11" title="Discussion about edits from this ip address [alt-shift-n]" accesskey="n" class="new">Talk for this IP</a></li>
				<li id="pt-anonlogin"><a href="http://wiki.interwoven.com/opwiki/index.php?title=Special:UserLogin&amp;returnto=Clickthru_-_Tracking_a_DIV_onclick" title="You are encouraged to log in, it is not mandatory however. [alt-shift-o]" accesskey="o">Log in / create account</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a style="background-image: url(http://wiki.interwoven.com/opwiki/images/1/18/Logo_optimost.gif);" href="http://wiki.interwoven.com/optimost/Home" title="Visit the Main Page [alt-shift-z]" accesskey="z"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
	<div id="p-search" class="portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="searchBody" class="pBody">
			<form action="/optimost/Special:Search" id="searchform"><div>
				<input id="searchInput" name="search" title="Search Optimost Wiki [alt-shift-f]" accesskey="f" type="text">
				<input name="go" class="searchButton" id="searchGoButton" value="Go" title="Go to a page with this exact name if exists" type="submit">&nbsp;
				<input name="fulltext" class="searchButton" id="mw-searchButton" value="Search" title="Search the pages for this text" type="submit">
			</div></form>
		</div>
	</div>
	<div class="generated-sidebar portlet" id="p-navigation">
		<h5>Navigation</h5>
		<div class="pBody">
			<ul>
				<li id="n-mainpage"><a href="http://wiki.interwoven.com/optimost/Home" title="Visit the Main Page [alt-shift-z]" accesskey="z">Home</a></li>
				<li id="n-recentchanges"><a href="http://wiki.interwoven.com/optimost/Special:RecentChanges" title="The list of recent changes in the wiki. [alt-shift-r]" accesskey="r">Recent changes</a></li>
				<li id="n-randompage"><a href="http://wiki.interwoven.com/optimost/Special:Random" title="Load a random page [alt-shift-x]" accesskey="x">Random page</a></li>
				<li id="n-Accounts"><a href="http://wiki.interwoven.com/optimost/Accounts">Accounts</a></li>
				<li id="n-Glossary"><a href="http://wiki.interwoven.com/optimost/Glossary">Glossary</a></li>
				<li id="n-help"><a href="http://wiki.interwoven.com/optimost/Help:Contents" title="The place to find out.">Help</a></li>
			</ul>
		</div>
	</div>
	<div class="generated-sidebar portlet" id="p-departments">
		<h5>departments</h5>
		<div class="pBody">
			<ul>
				<li id="n-Analytics"><a href="http://wiki.interwoven.com/optimost/Analytics_%28Department%29">Analytics</a></li>
				<li id="n-Client-Services"><a href="http://wiki.interwoven.com/optimost/Category:Client_Services">Client Services</a></li>
				<li id="n-Documentation"><a href="http://wiki.interwoven.com/optimost/Documentation">Documentation</a></li>
				<li id="n-Engineering"><a href="http://wiki.interwoven.com/optimost/Engineering">Engineering</a></li>
				<li id="n-Quality-Assurance"><a href="http://wiki.interwoven.com/optimost/Category:Quality_Assurance">Quality Assurance</a></li>
				<li id="n-Technical-Consulting"><a href="http://wiki.interwoven.com/optimost/Technical_consulting">Technical Consulting</a></li>
				<li id="n-Training-.26-Education"><a href="http://wiki.interwoven.com/optimost/Training_and_education">Training &amp; Education</a></li>
			</ul>
		</div>
	</div>
	<div class="generated-sidebar portlet" id="p-links">
		<h5>links</h5>
		<div class="pBody">
			<ul>
				<li id="n-Optimost-Console"><a href="http://asp.optimost.com/agency">Optimost Console</a></li>
				<li id="n-Optimost-Public-Site"><a href="http://www.interwoven.com/optimost">Optimost Public Site</a></li>
				<li id="n-Netspeed"><a href="http://netspeed/">Netspeed</a></li>
				<li id="n-SalesSite"><a href="http://salessite/">SalesSite</a></li>
				<li id="n-WorkSite"><a href="https://worksitemp.interwoven.com/worksitemp/link//V3/INTERWOVEN/C/F$217/C$14610/">WorkSite</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Toolbox</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="http://wiki.interwoven.com/optimost/Special:WhatLinksHere/Clickthru_-_Tracking_a_DIV_onclick" title="List of all wiki pages that link here [alt-shift-j]" accesskey="j">What links here</a></li>
				<li id="t-recentchangeslinked"><a href="http://wiki.interwoven.com/optimost/Special:RecentChangesLinked/Clickthru_-_Tracking_a_DIV_onclick" title="Recent changes in pages linked from this page [alt-shift-k]" accesskey="k">Related changes</a></li>
<li id="t-upload"><a href="http://wiki.interwoven.com/optimost/Special:Upload" title="Upload files [alt-shift-u]" accesskey="u">Upload file</a></li>
<li id="t-specialpages"><a href="http://wiki.interwoven.com/optimost/Special:SpecialPages" title="List of all special pages [alt-shift-q]" accesskey="q">Special pages</a></li>
				<li id="t-print"><a href="http://wiki.interwoven.com/opwiki/index.php?title=Clickthru_-_Tracking_a_DIV_onclick&amp;printable=yes" title="Printable version of this page [alt-shift-p]" accesskey="p">Printable version</a></li>				<li id="t-permalink"><a href="http://wiki.interwoven.com/opwiki/index.php?title=Clickthru_-_Tracking_a_DIV_onclick&amp;oldid=4580" title="Permanent link to this version of the page">Permanent link</a></li>			</ul>
		</div>
	</div>
		</div><!-- end of the left (by default at least) column -->
			<div class="visualClear"></div>
			<div id="footer">
				<div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="Clickthru%20-%20Tracking%20a%20DIV%20onclick%20-%20Optimost%20Wiki_files/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki"></a></div>
			<ul id="f-list">
				<li id="lastmod"> This page was last modified on 8 January 2010, at 14:53.</li>
				<li id="viewcount">This page has been accessed 44 times.</li>
				<li id="privacy"><a href="http://wiki.interwoven.com/optimost/Optimost_Wiki:Privacy_policy" title="Optimost Wiki:Privacy policy">Privacy policy</a></li>
				<li id="about"><a href="http://wiki.interwoven.com/optimost/Optimost_Wiki:About" title="Optimost Wiki:About">About Optimost Wiki</a></li>
				<li id="disclaimer"><a href="http://wiki.interwoven.com/optimost/Optimost_Wiki:General_disclaimer" title="Optimost Wiki:General disclaimer">Disclaimers</a></li>
			</ul>
		</div>
</div>

		<script type="text/javascript">if (window.runOnloadHook) runOnloadHook();</script>
<!-- Served in 0.198 secs. -->
</body></html>