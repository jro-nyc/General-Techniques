<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" dir="ltr" lang="en"><head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<meta name="generator" content="MediaWiki 1.13.1">
		<meta name="keywords" content="ASP.NET AJAX and Optimost,AJAX">
		<link rel="shortcut icon" href="http://wiki.interwoven.com/favicon.ico">
		<link rel="search" type="application/opensearchdescription+xml" href="http://wiki.interwoven.com/opwiki/opensearch_desc.php" title="Optimost Wiki (en)">
		<link rel="alternate" type="application/rss+xml" title="Optimost Wiki RSS Feed" href="http://wiki.interwoven.com/opwiki/index.php?title=Special:RecentChanges&amp;feed=rss">
		<link rel="alternate" type="application/atom+xml" title="Optimost Wiki Atom Feed" href="http://wiki.interwoven.com/opwiki/index.php?title=Special:RecentChanges&amp;feed=atom">
		<title>ASP.NET AJAX and Optimost - Optimost Wiki</title>
		<style type="text/css" media="screen, projection">/*<![CDATA[*/
			@import "/opwiki/skins/common/shared.css?164";
			@import "/opwiki/skins/monobook/main.css?164";
		/*]]>*/</style>
		<link rel="stylesheet" type="text/css" media="print" href="ASP.NET%20AJAX%20and%20Optimost%20-%20Optimost%20Wiki_files/commonPrint.css">
		<!--[if lt IE 5.5000]><style type="text/css">@import "/opwiki/skins/monobook/IE50Fixes.css?164";</style><![endif]-->
		<!--[if IE 5.5000]><style type="text/css">@import "/opwiki/skins/monobook/IE55Fixes.css?164";</style><![endif]-->
		<!--[if IE 6]><style type="text/css">@import "/opwiki/skins/monobook/IE60Fixes.css?164";</style><![endif]-->
		<!--[if IE 7]><style type="text/css">@import "/opwiki/skins/monobook/IE70Fixes.css?164";</style><![endif]-->
		<!--[if lt IE 7]><script type="text/javascript" src="/opwiki/skins/common/IEFixes.js?164"></script>
		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->
		
		<script type="text/javascript">/*<![CDATA[*/
var skin = "monobook";
var stylepath = "/opwiki/skins";
var wgArticlePath = "/optimost/$1";
var wgScriptPath = "/opwiki";
var wgScript = "/opwiki/index.php";
var wgVariantArticlePath = false;
var wgActionPaths = [];
var wgServer = "http://wiki.interwoven.com";
var wgCanonicalNamespace = "";
var wgCanonicalSpecialPageName = false;
var wgNamespaceNumber = 0;
var wgPageName = "ASP.NET_AJAX_and_Optimost";
var wgTitle = "ASP.NET AJAX and Optimost";
var wgAction = "view";
var wgArticleId = "659";
var wgIsArticle = true;
var wgUserName = null;
var wgUserGroups = null;
var wgUserLanguage = "en";
var wgContentLanguage = "en";
var wgBreakFrames = false;
var wgCurRevisionId = "3968";
var wgVersion = "1.13.1";
var wgEnableAPI = true;
var wgEnableWriteAPI = false;
var wgRestrictionEdit = [];
var wgRestrictionMove = [];
/*]]>*/</script>
                
		<script type="text/javascript" src="ASP.NET%20AJAX%20and%20Optimost%20-%20Optimost%20Wiki_files/wikibits.js"><!-- wikibits js --></script>
		<!-- Head Scripts -->
		<script type="text/javascript" src="ASP.NET%20AJAX%20and%20Optimost%20-%20Optimost%20Wiki_files/ajax.js"></script>
		<script type="text/javascript" src="ASP.NET%20AJAX%20and%20Optimost%20-%20Optimost%20Wiki_files/index.php"><!-- site js --></script><script type="text/javascript" src="ASP.NET%20AJAX%20and%20Optimost%20-%20Optimost%20Wiki_files/index_002.php"></script>
		<style type="text/css">/*<![CDATA[*/
@import "/opwiki/index.php?title=MediaWiki:Common.css&usemsgcache=yes&action=raw&ctype=text/css&smaxage=18000";
@import "/opwiki/index.php?title=MediaWiki:Monobook.css&usemsgcache=yes&action=raw&ctype=text/css&smaxage=18000";
@import "/opwiki/index.php?title=-&action=raw&gen=css&maxage=18000";
/*]]>*/</style>
	</head>
<body class="mediawiki ns-0 ltr page-ASP_NET_AJAX_and_Optimost">
	<div id="globalWrapper">
		<div id="column-content">
	<div id="content">
		<a name="top" id="top"></a>
				<h1 class="firstHeading">ASP.NET AJAX and Optimost</h1>
		<div id="bodyContent">
			<h3 id="siteSub">From Optimost Wiki</h3>
			<div id="contentSub"></div>
									<div id="jump-to-nav">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>			<!-- start content -->
			<table id="toc" class="toc" summary="Contents"><tbody><tr><td><div id="toctitle"><h2>Contents</h2> <span class="toctoggle">[<a href="javascript:toggleToc()" class="internal" id="togglelink">hide</a>]</span></div>
<ul>
<li class="toclevel-1"><a href="#The_Problem"><span class="tocnumber">1</span> <span class="toctext">The Problem</span></a></li>
<li class="toclevel-1"><a href="#The_Solution"><span class="tocnumber">2</span> <span class="toctext">The Solution</span></a></li>
<li class="toclevel-1"><a href="#Limitations"><span class="tocnumber">3</span> <span class="toctext">Limitations</span></a></li>
<li class="toclevel-1"><a href="#How_do_I_know_if_the_page_uses_UpdatePanels.3F"><span class="tocnumber">4</span> <span class="toctext">How do I know if the page uses UpdatePanels?</span></a></li>
<li class="toclevel-1"><a href="#What_if_I_need_to_know_which_UpdatePanel_was_updated.3F"><span class="tocnumber">5</span> <span class="toctext">What if I need to know which UpdatePanel was updated?</span></a></li>
<li class="toclevel-1"><a href="#See_also"><span class="tocnumber">6</span> <span class="toctext">See also</span></a></li>
</ul>
</td></tr></tbody></table><script type="text/javascript"> if (window.showTocToggle) { var tocShowText = "show"; var tocHideText = "hide"; showTocToggle(); } </script>
<a name="The_Problem"></a><h2> <span class="mw-headline">The Problem</span></h2>
<p>Several of our clients use ASP.NET and Microsoft AJAX Toolkit on 
their pages. This often involves them updating large areas of the page 
using UpdatePanel controls, which can be a problem for us as it will 
undo any changes we have made to this area (unless they are pure CSS 
changes). We need to run our javascript code to update the area each 
time the UpdatePanel is updated.
</p><p>It is difficult to add hooks in the normal way as the AJAX code 
that updated the UpdatePanel is automatically generated by .NET and our 
client's developers may not know how to modify it. It is not possible 
for us to add them by directly modifiying the functions ourselves as it 
very difficult to understand exactly which functions are being called 
and the Microsoft Ajax Toolkit includes thousands of lines of code.
</p><p><br>
</p>
<a name="The_Solution"></a><h2> <span class="mw-headline">The Solution</span></h2>
<p>Microsoft creates an event called pageLoaded which runs not only on 
the first page load, but also when any UpdatePanel is updated. We can 
add a handler for this event like this:
</p>
<pre>var prm = Sys.WebForms.PageRequestManager.getInstance();
prm.add_pageLoaded(runOptimost);
</pre>
<p>The first line of this returns the instance of the 
Sys.WebForms.PageRequestManager class for this page, allowing us to call
 its methods.
The second line calls the add_pageLoaded method which adds a function as
 a handler for the pageLoaded event. This handler is then called any 
time content on the page is refreshed, whether by a normal browser 
refresh or by AJAX updating the UpdatePanels. More information on the 
pageLoaded event can be found here: <a href="http://msdn.microsoft.com/en-us/library/bb397523.aspx" class="external free" title="http://msdn.microsoft.com/en-us/library/bb397523.aspx" rel="nofollow">http://msdn.microsoft.com/en-us/library/bb397523.aspx</a>
</p><p>The runOptimost function would be a function which runs any of 
our code that needs to be rerun when the UpdatePanel updates, for 
example changing the src of a button within the UpdatePanel area.
</p>
<a name="Limitations"></a><h2> <span class="mw-headline">Limitations</span></h2>
<p>This method is only known to work when UpdatePanel controls are used,
 which may not be the case in all pages which use ASP.NET and AJAX.
</p>
<a name="How_do_I_know_if_the_page_uses_UpdatePanels.3F"></a><h2> <span class="mw-headline">How do I know if the page uses UpdatePanels?</span></h2>
<p>1. 'updatepanel' is usually somewhere in the <b>id</b> of the div or 
span which forms the update panel e.g 
'ctl01_ContentPlaceHolder1_m_mediaControl_storelocator1_storeupdatepanel'.
 However this is not always the case.
2. Look at the <b>XHR</b> area within the <b>Net tab</b> in <b>firebug</b>
 after causing the area you are interested in to be updated (depending 
on the page this may happen automatically very so often, or it may 
require a button click or change of form input). If the page is updating
 using AJAX you should see at least one request there (probably a POST).
 If you look at the response data for this request the first line of 
this will contain <b>|updatePanel|</b> if an UpdatePanel has been updated.
e.g.
</p><p><a href="http://wiki.interwoven.com/optimost/Image:UpdatePanelExample.png" class="image" title="Image:UpdatePanelExample.png"><img alt="Image:UpdatePanelExample.png" src="ASP.NET%20AJAX%20and%20Optimost%20-%20Optimost%20Wiki_files/UpdatePanelExample.png" height="421" border="0" width="1250"></a>
</p>
<a name="What_if_I_need_to_know_which_UpdatePanel_was_updated.3F"></a><h2> <span class="mw-headline">What if I need to know which UpdatePanel was updated?</span></h2>
<p>Sometimes there are multiple UpdatePanels on the page but we may want
 to run code only if a certain UpdatePanel is updated.
For example, if a button click updates a mini shopping cart on a product
 page, we may want to fire a counter to track the click (the .NET AJAX 
craziness makes it difficult track the click any other way).
</p><p>When the pageLoaded event occurs is called, two arguments are 
passed to the handler function 'sender' and 'args'. We are only 
interested in the args, which is an object with some properties we can 
use to determine what was updated. The <b>panelsUpdated</b> property of 
the args object contains an array of the ids of the panels that were 
updated, so if we know the id of the UpdatePanel we care about we can 
cycle through this array to see if it is in the list. We can get this 
array by calling <b>args.get_panelsUpdated()</b> - below is an example of how this might be used to fire an image counter only if a certain UpdatePanel is updated.
</p>
<pre>
function opFireCounter(sender, args){
		if(args){
					var updatedPanels = args.get_panelsUpdated();
					for (var i=0; i &lt; updatedPanels.length; i++) {            
						if(updatedPanels[i].id.indexOf('ctl01_ucMiniCart_m_miniCartUdatePanel')!=-1){
								fireImgCounter();

						}
					}
		}
}

var prm = Sys.WebForms.PageRequestManager.getInstance();
prm.add_pageLoaded(opFireCounter);
</pre>
<a name="See_also"></a><h2> <span class="mw-headline">See also</span></h2>
<p><a href="http://msdn.microsoft.com/en-us/library/bb398976.aspx" class="external text" title="http://msdn.microsoft.com/en-us/library/bb398976.aspx" rel="nofollow">Microsoft's reference on all the events generated by AJAX postbacks, including pageLoaded</a>
</p><p><a href="http://wiki.interwoven.com/optimost/AJAX" title="AJAX">How we normally tackle AJAX</a>
</p>
<!-- 
NewPP limit report
Preprocessor node count: 13/1000000
Post-expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key optimost_wiki:pcache:idhash:659-0!1!0!!en!2!edit=0 and timestamp 20130816144733 -->
<div class="printfooter">
Retrieved from "<a href="http://wiki.interwoven.com/optimost/ASP.NET_AJAX_and_Optimost">http://wiki.interwoven.com/optimost/ASP.NET_AJAX_and_Optimost</a>"</div>
			<div id="catlinks" class="catlinks"><div id="mw-normal-catlinks"><a href="http://wiki.interwoven.com/optimost/Special:Categories" title="Special:Categories">Category</a>: <span dir="ltr"><a href="http://wiki.interwoven.com/opwiki/index.php?title=Category:AJAX&amp;action=edit&amp;redlink=1" class="new" title="Category:AJAX (not yet written)">AJAX</a></span></div></div>			<!-- end content -->
			<div class="visualClear"></div>
		</div>
	</div>
		</div>
		<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<div class="pBody">
			<ul>
	
				 <li id="ca-nstab-main" class="selected"><a href="http://wiki.interwoven.com/optimost/ASP.NET_AJAX_and_Optimost" title="View the content page [alt-shift-c]" accesskey="c">Page</a></li>
				 <li id="ca-talk" class="new"><a href="http://wiki.interwoven.com/opwiki/index.php?title=Talk:ASP.NET_AJAX_and_Optimost&amp;action=edit" title="Discussion about the content page [alt-shift-t]" accesskey="t">Discussion</a></li>
				 <li id="ca-viewsource"><a href="http://wiki.interwoven.com/opwiki/index.php?title=ASP.NET_AJAX_and_Optimost&amp;action=edit" title="This page is protected.
You can view its source. [alt-shift-e]" accesskey="e">View source</a></li>
				 <li id="ca-history"><a href="http://wiki.interwoven.com/opwiki/index.php?title=ASP.NET_AJAX_and_Optimost&amp;action=history" title="Past versions of this page. [alt-shift-h]" accesskey="h">History</a></li>			</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
				<li id="pt-anonuserpage"><a href="http://wiki.interwoven.com/optimost/User:10.26.10.11" title="The user page for the ip you're editing as [alt-shift-.]" accesskey="." class="new">10.26.10.11</a></li>
				<li id="pt-anontalk"><a href="http://wiki.interwoven.com/optimost/User_talk:10.26.10.11" title="Discussion about edits from this ip address [alt-shift-n]" accesskey="n" class="new">Talk for this IP</a></li>
				<li id="pt-anonlogin"><a href="http://wiki.interwoven.com/opwiki/index.php?title=Special:UserLogin&amp;returnto=ASP.NET_AJAX_and_Optimost" title="You are encouraged to log in, it is not mandatory however. [alt-shift-o]" accesskey="o">Log in / create account</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a style="background-image: url(http://wiki.interwoven.com/opwiki/images/1/18/Logo_optimost.gif);" href="http://wiki.interwoven.com/optimost/Home" title="Visit the Main Page [alt-shift-z]" accesskey="z"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
	<div id="p-search" class="portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="searchBody" class="pBody">
			<form action="/optimost/Special:Search" id="searchform"><div>
				<input id="searchInput" name="search" title="Search Optimost Wiki [alt-shift-f]" accesskey="f" type="text">
				<input name="go" class="searchButton" id="searchGoButton" value="Go" title="Go to a page with this exact name if exists" type="submit">&nbsp;
				<input name="fulltext" class="searchButton" id="mw-searchButton" value="Search" title="Search the pages for this text" type="submit">
			</div></form>
		</div>
	</div>
	<div class="generated-sidebar portlet" id="p-navigation">
		<h5>Navigation</h5>
		<div class="pBody">
			<ul>
				<li id="n-mainpage"><a href="http://wiki.interwoven.com/optimost/Home" title="Visit the Main Page [alt-shift-z]" accesskey="z">Home</a></li>
				<li id="n-recentchanges"><a href="http://wiki.interwoven.com/optimost/Special:RecentChanges" title="The list of recent changes in the wiki. [alt-shift-r]" accesskey="r">Recent changes</a></li>
				<li id="n-randompage"><a href="http://wiki.interwoven.com/optimost/Special:Random" title="Load a random page [alt-shift-x]" accesskey="x">Random page</a></li>
				<li id="n-Accounts"><a href="http://wiki.interwoven.com/optimost/Accounts">Accounts</a></li>
				<li id="n-Glossary"><a href="http://wiki.interwoven.com/optimost/Glossary">Glossary</a></li>
				<li id="n-help"><a href="http://wiki.interwoven.com/optimost/Help:Contents" title="The place to find out.">Help</a></li>
			</ul>
		</div>
	</div>
	<div class="generated-sidebar portlet" id="p-departments">
		<h5>departments</h5>
		<div class="pBody">
			<ul>
				<li id="n-Analytics"><a href="http://wiki.interwoven.com/optimost/Analytics_%28Department%29">Analytics</a></li>
				<li id="n-Client-Services"><a href="http://wiki.interwoven.com/optimost/Category:Client_Services">Client Services</a></li>
				<li id="n-Documentation"><a href="http://wiki.interwoven.com/optimost/Documentation">Documentation</a></li>
				<li id="n-Engineering"><a href="http://wiki.interwoven.com/optimost/Engineering">Engineering</a></li>
				<li id="n-Quality-Assurance"><a href="http://wiki.interwoven.com/optimost/Category:Quality_Assurance">Quality Assurance</a></li>
				<li id="n-Technical-Consulting"><a href="http://wiki.interwoven.com/optimost/Technical_consulting">Technical Consulting</a></li>
				<li id="n-Training-.26-Education"><a href="http://wiki.interwoven.com/optimost/Training_and_education">Training &amp; Education</a></li>
			</ul>
		</div>
	</div>
	<div class="generated-sidebar portlet" id="p-links">
		<h5>links</h5>
		<div class="pBody">
			<ul>
				<li id="n-Optimost-Console"><a href="http://asp.optimost.com/agency">Optimost Console</a></li>
				<li id="n-Optimost-Public-Site"><a href="http://www.interwoven.com/optimost">Optimost Public Site</a></li>
				<li id="n-Netspeed"><a href="http://netspeed/">Netspeed</a></li>
				<li id="n-SalesSite"><a href="http://salessite/">SalesSite</a></li>
				<li id="n-WorkSite"><a href="https://worksitemp.interwoven.com/worksitemp/link//V3/INTERWOVEN/C/F$217/C$14610/">WorkSite</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Toolbox</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="http://wiki.interwoven.com/optimost/Special:WhatLinksHere/ASP.NET_AJAX_and_Optimost" title="List of all wiki pages that link here [alt-shift-j]" accesskey="j">What links here</a></li>
				<li id="t-recentchangeslinked"><a href="http://wiki.interwoven.com/optimost/Special:RecentChangesLinked/ASP.NET_AJAX_and_Optimost" title="Recent changes in pages linked from this page [alt-shift-k]" accesskey="k">Related changes</a></li>
<li id="t-upload"><a href="http://wiki.interwoven.com/optimost/Special:Upload" title="Upload files [alt-shift-u]" accesskey="u">Upload file</a></li>
<li id="t-specialpages"><a href="http://wiki.interwoven.com/optimost/Special:SpecialPages" title="List of all special pages [alt-shift-q]" accesskey="q">Special pages</a></li>
				<li id="t-print"><a href="http://wiki.interwoven.com/opwiki/index.php?title=ASP.NET_AJAX_and_Optimost&amp;printable=yes" title="Printable version of this page [alt-shift-p]" accesskey="p">Printable version</a></li>				<li id="t-permalink"><a href="http://wiki.interwoven.com/opwiki/index.php?title=ASP.NET_AJAX_and_Optimost&amp;oldid=3968" title="Permanent link to this version of the page">Permanent link</a></li>			</ul>
		</div>
	</div>
		</div><!-- end of the left (by default at least) column -->
			<div class="visualClear"></div>
			<div id="footer">
				<div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="ASP.NET%20AJAX%20and%20Optimost%20-%20Optimost%20Wiki_files/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki"></a></div>
			<ul id="f-list">
				<li id="lastmod"> This page was last modified on 17 February 2009, at 13:15.</li>
				<li id="viewcount">This page has been accessed 88 times.</li>
				<li id="privacy"><a href="http://wiki.interwoven.com/optimost/Optimost_Wiki:Privacy_policy" title="Optimost Wiki:Privacy policy">Privacy policy</a></li>
				<li id="about"><a href="http://wiki.interwoven.com/optimost/Optimost_Wiki:About" title="Optimost Wiki:About">About Optimost Wiki</a></li>
				<li id="disclaimer"><a href="http://wiki.interwoven.com/optimost/Optimost_Wiki:General_disclaimer" title="Optimost Wiki:General disclaimer">Disclaimers</a></li>
			</ul>
		</div>
</div>

		<script type="text/javascript">if (window.runOnloadHook) runOnloadHook();</script>
<!-- Served in 0.219 secs. -->
</body></html>